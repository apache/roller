
<!-- TOMCAT RESOURCE REF -->
    <resource-ref>
            <res-ref-name>jdbc/rollerdb</res-ref-name>
            <res-type>javax.sql.DataSource</res-type>
            <res-auth>Container</res-auth>
    </resource-ref>

<!-- Uncomment this for email notification of comments
    <resource-ref>
        <res-ref-name>mail/Session</res-ref-name>
        <res-type>javax.mail.Session</res-type>
        <res-auth>Container</res-auth>
    </resource-ref>
-->

<!-- Uncomment this security constrain if secure_login is enabled
<security-constraint>
    <web-resource-collection>
        <web-resource-name>SecureLogin</web-resource-name>
        <description>Protects login pages with SSL</description> 
        <url-pattern>/j_security_check</url-pattern>        
        <url-pattern>/loginerror.jsp</url-pattern>
        <url-pattern>/login-redirect.jsp</url-pattern>
        <url-pattern>/login.jsp</url-pattern>         
        <http-method>POST</http-method>
        <http-method>GET</http-method>
    </web-resource-collection>  
    <user-data-constraint>
        <description></description>
        <transport-guarantee>CONFIDENTIAL</transport-guarantee>
    </user-data-constraint> 
</security-constraint>
 -->
 
<security-constraint>
    <web-resource-collection>
        <web-resource-name>EditorPages</web-resource-name>
        <description>Editor pages</description>        
        <url-pattern>/editor/*</url-pattern>
        <url-pattern>/login-redirect.jsp</url-pattern>
        <http-method>POST</http-method>
        <http-method>GET</http-method>
    </web-resource-collection>   
    <auth-constraint>
        <description>Editors and Administrators only</description>
        <role-name>admin</role-name>
        <role-name>editor</role-name>
    </auth-constraint>
</security-constraint>

<security-constraint>
    <web-resource-collection>
        <web-resource-name>AdminPages</web-resource-name>
        <description>Administration pages</description>        
        <url-pattern>/admin/*</url-pattern>
        <http-method>POST</http-method>
        <http-method>GET</http-method>
    </web-resource-collection>   
    <auth-constraint>
        <description>Administrators only</description>
        <role-name>admin</role-name>
    </auth-constraint>
</security-constraint>

<!-- Login and login error pages -->
<login-config>
    <!-- RESIN_AUTHENTICATOR -->
    <auth-method>FORM</auth-method>
    <form-login-config>
        <form-login-page>/login.jsp</form-login-page>
        <form-error-page>/loginerror.jsp</form-error-page>
    </form-login-config>
</login-config>

<security-role>
    <description>The Administrator Role</description>
    <role-name>admin</role-name>
</security-role>

<security-role>
    <description>The Editor Role</description>
    <role-name>editor</role-name>
</security-role>

