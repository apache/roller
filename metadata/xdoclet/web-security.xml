
<!-- TOMCAT RESOURCE REF -->
    <resource-ref>
            <res-ref-name>jdbc/rollerdb</res-ref-name>
            <res-type>javax.sql.DataSource</res-type>
            <res-auth>Container</res-auth>
    </resource-ref>

<!-- Uncomment this for email notification of comments
    <resource-ref>
        <res-ref-name>mail/Session</res-ref-name>
        <res-type>javax.mail.Session</res-type>
        <res-auth>Container</res-auth>
    </resource-ref>
-->

<!-- Only allow editors to access edit-*.jsp pages -->
<security-constraint>

    <web-resource-collection>
        <web-resource-name>EditPages</web-resource-name>
        <description>Only allow editors to access editor pages</description>
        
        <url-pattern>/admin/*</url-pattern>
        <url-pattern>/adminUser.do</url-pattern>
        <url-pattern>/uploadFiles.do</url-pattern>
                        
        <url-pattern>/bookmarks/*</url-pattern>        
        <url-pattern>/bookmark.do</url-pattern>
        <url-pattern>/bookmark.do</url-pattern>
        <url-pattern>/folder.do</url-pattern>
        <url-pattern>/importBookmarks.do</url-pattern>
        
        <url-pattern>/bookmarks.do</url-pattern>
        <url-pattern>/bookmarkEdit.do</url-pattern>
        <url-pattern>/bookmarkSave.do</url-pattern>
        <url-pattern>/folderEdit.do</url-pattern>
        <url-pattern>/folderSave.do</url-pattern>
        
        <url-pattern>/weblog/*</url-pattern>
        <url-pattern>/weblog.do</url-pattern>
        <url-pattern>/weblogQuery.do</url-pattern>
        <url-pattern>/categoryEdit.do</url-pattern>
        <url-pattern>/categorySave.do</url-pattern>
        <url-pattern>/exportEntries.do</url-pattern>
        <url-pattern>/importEntries.do</url-pattern>
        
        <url-pattern>/referers.do</url-pattern>
                       
        <url-pattern>/website/*</url-pattern>
        <url-pattern>/website.do</url-pattern>
        
        <url-pattern>/pages/*</url-pattern>
        <url-pattern>/page.do</url-pattern>
        
        <url-pattern>/login-redirect.jsp</url-pattern>
        
        <url-pattern>/edit-user.jsp</url-pattern>
        
        <url-pattern>/templates/*</url-pattern>
                
        <http-method>POST</http-method>
        <http-method>GET</http-method>
    </web-resource-collection>
    
    <auth-constraint>
        <description>Only let editors log in</description>
        <role-name>editor</role-name>
    </auth-constraint>

</security-constraint>

<!-- Login and login error pages -->
<login-config>

    <!-- RESIN_AUTHENTICATOR -->

    <auth-method>FORM</auth-method>
    <form-login-config>
        <form-login-page>/login.jsp</form-login-page>
        <form-error-page>/loginerror.jsp</form-error-page>
    </form-login-config>
</login-config>

<!-- The editor role -->
<security-role>
    <description>The Editor Role</description>
    <role-name>editor</role-name>
</security-role>

