
<!-- *********************************************************
    Filter mappings - order IS important here.  Since there is
    no way to declare order in xdoclet, we must do it by hand.
    ******************************************************* -->

<!--
     NOTE: Wherever "dispatcher" elements are specified in the filter mappings, they are
     required for Servlet API 2.4 containers, such as Tomcat 5+ and Resin 3+, but should be
     commented out for Servlet API 2.3 containers, like Tomcat 4.x and Resin 2.x.
-->

<!--
<filter-mapping>
    <filter-name>UrlRewriteFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
-->

<!-- Ensures character encoding set to UTF-8 and JSTL and Struts locales are in sync.
Note: Any filters preceding this one MUST not cause request parsing. -->
<filter-mapping>
    <filter-name>CharEncodingFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping>

<!-- Acegi Security filters - controls secure access to different parts of Roller -->
<filter-mapping>
    <filter-name>securityFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping>

<!-- Map everything to the PersistenceSessionFilter.
     NOTE: Any filters preceding this one MUST NOT use persistence sessions.-->
<filter-mapping>
    <filter-name>PersistenceSessionFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping>


<filter-mapping>
    <filter-name>RefererFilter</filter-name>
    <url-pattern>/page/*</url-pattern>
</filter-mapping>

<filter-mapping>
    <filter-name>BreadCrumbFilter</filter-name>
    <url-pattern>*.do</url-pattern>
</filter-mapping>


<!-- cache lastModified dates used for HTTP 304 responses -->
<filter-mapping>
    <filter-name>IfModifiedFeedCacheFilter</filter-name>
    <url-pattern>/rss/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>IfModifiedFeedCacheFilter</filter-name>
    <url-pattern>/atom/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>IfModifiedFeedCacheFilter</filter-name>
    <url-pattern>/flavor/*</url-pattern>
</filter-mapping>

<filter-mapping>
    <filter-name>IfPlanetModifiedFilter</filter-name>
    <url-pattern>/planetrss/*</url-pattern>
</filter-mapping>


<!-- Compression Filters -->
<filter-mapping>
    <filter-name>PageGzipFilter</filter-name>
    <url-pattern>/page/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>PageGzipFilter</filter-name>
    <url-pattern>/planet.do</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>PageGzipFilter</filter-name>
    <url-pattern>/main.do</url-pattern>
</filter-mapping>

<filter-mapping>
    <filter-name>RssGzipFilter</filter-name>
    <url-pattern>/atom/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>RssGzipFilter</filter-name>
    <url-pattern>/rss/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>RssGzipFilter</filter-name>
    <url-pattern>/flavor/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>RssGzipFilter</filter-name>
    <url-pattern>/foaf/*</url-pattern>
</filter-mapping>


<!-- Feed Caching (rss, atom, etc) -->
<filter-mapping>
    <filter-name>FeedCacheFilter</filter-name>
    <url-pattern>/rss/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>FeedCacheFilter</filter-name>
    <url-pattern>/atom/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>FeedCacheFilter</filter-name>
    <url-pattern>/flavor/*</url-pattern>
</filter-mapping>


<!-- Weblog Page Caching -->
<filter-mapping>
	<filter-name>WeblogPageCacheFilter</filter-name>
	<url-pattern>/page/*</url-pattern>
</filter-mapping>


<!-- Main Page Caching -->
<filter-mapping>
	<filter-name>MainPageCacheFilter</filter-name>
	<url-pattern>/main.do</url-pattern>
	<dispatcher>REQUEST</dispatcher>
	<dispatcher>FORWARD</dispatcher>
</filter-mapping>


<!-- Planet Roller Caching -->
<filter-mapping>
	<filter-name>PlanetCacheFilter</filter-name>
	<url-pattern>/planet.do</url-pattern>
	<dispatcher>REQUEST</dispatcher>
	<dispatcher>FORWARD</dispatcher>
</filter-mapping>
<filter-mapping>
    <filter-name>PlanetCacheFilter</filter-name>
    <url-pattern>/planetrss</url-pattern>
</filter-mapping>


<!-- Do we still need the RequestFilter? -->
<filter-mapping>
    <filter-name>RequestFilter</filter-name>
    <url-pattern>/page/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>RequestFilter</filter-name>
    <url-pattern>/preview/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>RequestFilter</filter-name>
    <url-pattern>/flavor/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>RequestFilter</filter-name>
    <url-pattern>/xmlrpc/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>RequestFilter</filter-name>
    <url-pattern>*.do</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping>
