
<!-- *********************************************************
    Filter mappings - order IS important here.  Since there is
    no way to declare order in xdoclet, we must do it by hand.
    ******************************************************* -->

<!--
     NOTE: Wherever "dispatcher" elements are specified in the filter mappings, they are
     required for Servlet API 2.4 containers, such as Tomcat 5+ and Resin 3+, but should be
     commented out for Servlet API 2.3 containers, like Tomcat 4.x and Resin 2.x.
-->

<!-- Ensures character encoding set to UTF-8 and JSTL and Struts locales are in sync.
Note: Any filters preceding this one MUST not cause request parsing. -->
<filter-mapping>
    <filter-name>CharEncodingFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping>

<!-- Scheme enforcement.  Only here until we get Acegi scheme enforcement working -->
<filter-mapping>
    <filter-name>SchemeEnforcementFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<!-- Acegi Security filters - controls secure access to different parts of Roller -->
<filter-mapping>
    <filter-name>securityFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping>

<!-- Map everything to the PersistenceSessionFilter.
     NOTE: Any filters preceding this one MUST NOT use persistence sessions.-->
<filter-mapping>
    <filter-name>PersistenceSessionFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping>

<filter-mapping>
    <filter-name>InitFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<filter-mapping>
    <filter-name>RequestMappingFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<filter-mapping>
    <filter-name>RefererFilter</filter-name>
    <url-pattern>/roller-ui/rendering/page/*</url-pattern>
</filter-mapping>

<filter-mapping>
    <filter-name>BreadCrumbFilter</filter-name>
    <url-pattern>*.do</url-pattern>
</filter-mapping>


<!-- Compression Filter -->
<filter-mapping>
    <filter-name>CompressionFilter</filter-name>
    <url-pattern>/roller-ui/rendering/page/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>CompressionFilter</filter-name>
    <url-pattern>/roller-ui/rendering/feed/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>CompressionFilter</filter-name>
    <url-pattern>/planet.do</url-pattern>
</filter-mapping>


<!-- Planet Roller Caching -->
<filter-mapping>
	<filter-name>PlanetCacheFilter</filter-name>
	<url-pattern>/planet.do</url-pattern>
	<dispatcher>REQUEST</dispatcher>
	<dispatcher>FORWARD</dispatcher>
</filter-mapping>
<filter-mapping>
    <filter-name>IfPlanetModifiedFilter</filter-name>
    <url-pattern>/planetrss/*</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>PlanetCacheFilter</filter-name>
    <url-pattern>/planetrss</url-pattern>
</filter-mapping>


<!-- Do we still need the RequestFilter? -->
<filter-mapping>
    <filter-name>RequestFilter</filter-name>
    <url-pattern>*.do</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping>
