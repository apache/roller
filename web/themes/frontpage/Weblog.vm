#includeTemplate($model.weblog "_header") 

#set($maxResults = 25)
#set($since = 365)

    <div id="centercontent_wrap">
        <div id="centercontent">  
            <h1>$config.siteName</h1>
            <p class="subtitle">$config.siteDescription</p> 

            <table class="menuTabTable" cellspacing="0"><tbody><tr>
               <td class="menuTabSelected">
                  <div class="menu-tr">
                     <div class="menu-tl">
                        &nbsp;&nbsp;<a href="$url.home">Recent Entries</a>&nbsp;&nbsp; 
                     </div>
                  </div>
               </td>	
               <td class="menuTabSeparator"></td>
               <td class="menuTabUnselected">
                  <div class="menu-tr">
                     <div class="menu-tl">
                        &nbsp;&nbsp;<a href="$url.home/page/directory">Weblog Directory</a>&nbsp;&nbsp; 
                     </div>
                  </div>
               </td>	    
               <td class="menuTabSeparator"></td>
            </tr></tbody></table>
            <table class="menuItemTable" cellspacing="0"><tbody><tr>
            <td class="padleft"></td></tr></tbody></table>

            <div id="tabContent">
                <div id="recentEntries">

                   
                    ## The below pager code should work against either:

                    ## 1) SITE-WIDE entries (the default)
                    #set($pager = $site.getWeblogEntriesPager($since, $maxResults))

                    ## 2) PLANET-entries
                    ## set($pager = $planet.getAggregationPager($since, $maxResults))


                    #if($pager.items.size() > 0)
                        #set($entryCount = $pager.items.size() - 1)
                        #set($startDate = $pager.items.get(0).pubTime)
                        #set($endDate = $entries.get($entryCount).pubTime)
                    #end
                    #foreach($entry in $pager.items)
                        #if($velocityCount < $maxResults)

                            <div class="entry">
                                <p class="entryDetails">
                                    <a href="$utils.escapeHTML($entry.permalink)">
                                    <b>$utils.truncateNicely($utils.removeHTML($entry.title), 50, 50, "...")</b></a><br /> 
                                    <a href="$utils.escapeHTML($entry.website.URL)">$entry.website.name</a>
                                    #if($entry.category.name)| $entry.category.name #end
                                    #if($entry.pubTime) | $utils.formatDate($entry.pubTime, $text.get("macro.weblog.date.toStringFormat")) #end
                                    #if($entry.creator.userName)| By $entry.creator.userName #end
                                    <br/> 
                                </p>
                                <p class="entryDescription">                    
                                    #if($entry.displayContent)
                                         $utils.truncateNicely($utils.removeHTML($entry.displayContent), 240, 260, "...")
                                    #else ## planet entries don't have displayContent
                                         $utils.truncateNicely($utils.removeHTML($entry.text), 240, 260, "...")
                                    #end
                                </p>
                            </div>

                        #end
                    #end
                    <div class="pagingcontrols">
                    #if($pager.nextLink)
                       <a href="$pager.nextLink">&lt; $pager.nextName</a>
                    #end
                    #if($pager.nextLink && $pager.prevLink)
                       &nbsp;|&nbsp;
                    #end
                    #if($pager.prevLink)
                       <a href="$pager.prevLink">$pager.prevName &gt;</a>
                    #end
                    </div>


                </div>
            </div>
            
            <br />
            <a href='$url.feed.entries.rss' title='Combined RSS feed for site.'>
            <img src='$url.absoluteSite/images/rssbadge.gif' border="0" alt='Combined RSS feed for site.' />
            </a>
            Right-click, copy link and paste into your newsfeed reader

        </div> 
    </div> 

    <div id="rightcontent_wrap">
        <div id="rightcontent"> 

           <div class="searchSidebarHead">
               <div class="menu-tr">
                   <div class="menu-tl">
                      <h3>&nbsp;</h3>
                   </div>

               </div>
           </div>

           <div class="searchSidebarBody">
                <h3>Search for blogs</h3>
                <form id="searchForm" method="get"
                   action="/sitesearch.do"
                   style="margin: 0; padding: 0" onsubmit="return validateSearch(this)">
                   <input type="text" id="q" name="q" size="20"
                       maxlength="255" value="" />
                   <input value="&nbsp;?&nbsp;" class="searchButton" type="submit">
                </form>
                <script type="text/javascript"> 
                   // <!--
                   function validateSearch(form) {
                       if (form.q.value == "") {
                           alert("Please enter a search term to continue.");
                           form.q.focus();
                           return false;
                       }
                       return true;
                   } 
                   // -->
                </script>
            </div>

            <br />
            <div class="sidebarBodyHead">
                <div class="menu-tr">
                    <div class="menu-tl">
                       <h3>Hot blogs (today's hits)</h3>		
                    </div>
                </div>
            </div>	

            <div class="sidebarBody">  
                #set($hotblogs = $site.getHotWeblogs($since, $maxResults))
                <ul>
                   #foreach($blog in $hotblogs)
                   <li>$blog.subjectNameShort | $blog.count</li>
                   #end
                </ul>   
                <br />		
            </div>

        </div>
    </div>

</div> <!-- wrapper -->

#includeTemplate($model.weblog "_footer")
